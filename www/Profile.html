<!doctype html>

<html lang="en">
<head>
  	<meta charset="UTF-8">
	<title>Profile</title>
	<meta name=“viewport” content=“width=device-width, intitial-scale=1.0”>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
	
	<link rel="stylesheet" type="text/css" href="bootstrap.css">
	<link rel="javascript" type="text/javascript" href="bootstrap.min.js">
  	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"> 
  	<link rel="stylesheet" href="css/login.css">

    <script src="https://cdn.firebase.com/js/client/2.4.0/firebase.js"></script>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script>
        
    <script>
        var myDataRef = new Firebase('https://mums.firebaseio.com/-KAbPmQRERC_vWbkdBgU');
            
        myDataRef.on('value', function(snapshot) {
            var message = snapshot.val();
            display(message.patient_fname, message.patient_lname, message.location, message.known_drug_allergies, message.medical_history);
        });
        
        function display(patient_fname, patient_lname, location, known_drug_allergies, medical_history) {
            
            $( '#patientTitle' ).append(patient_fname + ' ' + patient_lname);
            $( '#location' ).append(location);
            $( '#known_drug_allergies' ).append(known_drug_allergies);
            $( '#medical_history' ).append(medical_history);
        };    
        
    //TEST DATA ADD       
        function add(){
            var pH = Math.floor((Math.random() * 10) + 1);
            var nitrite = "Negative";
            var ketone = Math.floor((Math.random() * 10) + 1);
            var glucose = Math.floor((Math.random() * 10) + 1);
            var timeStamp = Firebase.ServerValue.TIMESTAMP;
            
            var testRef = myDataRef.child("tests");
            testRef.push({timeStamp: timeStamp,
                    pH: pH, 
                    nitrite: nitrite,
                    ketone: ketone,
                    glucose: glucose
            });   
            
        }   
        
        var dataLink = 'https://mums.firebaseio.com/-KAbPmQRERC_vWbkdBgU/tests';
        var DateRef = new Firebase(dataLink);
        var key;
        DateRef.on('child_added', function(snapshot) {
            var message = snapshot.val();
            key = snapshot.key();
            
            var linkDate = dataLink + '/' + key;
            $( '#dateDropdown').append(
                '<li><a onclick=overviewTable("'+ linkDate +'")>' + message.timeStamp + '</a></li>'
            );
            
            $( '#dateDropdown2').append(
                '<li><a onclick=resultsTable("'+ linkDate +'")>' + message.timeStamp + '</a></li>'
            );
            
        });

        
        function overviewTable (specKey) {           
            var ref = new Firebase(specKey);
            ref.on('value', function(snapshot) {
                var message = snapshot.val();

                $( '#tableTitle').text("Test: " + message.timeStamp);
                
                $( '#pH' ).text(message.pH);
                $( '#nitrite' ).text(message.nitrite);
                $( '#ketone' ).text(message.ketone);
                $( '#glucose' ).text(message.glucose);
            });    
       
        };
        
        function resultsTable (specKey) {           
            
            var ref = new Firebase(specKey);
            ref.on('value', function(snapshot) {
                var message = snapshot.val();

                $( '#tableTitle2').text("Test: " + message.timeStamp);
                
                checkColor(1, 5, 8, message.pH, pH2, pH_pos1, pH_pos2, pH_pos3);
                //FIX positive/negative color coding  
                checkColor("Negative", "Positive", null, message.nitrite, nitrite2, nitrite_pos1, nitrite_pos2, nitrite_pos3);      
                checkColor(1, 5, 8, message.ketone, ketone2, ketone_pos1, ketone_pos2, ketone_pos3);
                checkColor(1, 5, 8, message.glucose, glucose2, glucose_pos1, glucose_pos2, glucose_pos3);
            });    
        };
        
        function checkColor(check1, check2, check3, actualValue, td1, td2, td3, td4) {         
            $( '#' + td1.id).text(actualValue);
            
            //Set Negative
            if(actualValue <= check1){
                $( '#' + td1.id).css("background-color", "lime");
                $( '#' + td2.id).css("background-color", "white");  
                $( '#' + td3.id).css("background-color", "white");  
                $( '#' + td4.id).css("background-color", "white");
            }
            //Set Positive 1
            else if(actualValue > check1 && actualValue <= check2){
                $( '#' + td1.id).css("background-color", "yellow");
                $( '#' + td2.id).css("background-color", "yellow");
                $( '#' + td3.id).css("background-color", "white");  
                $( '#' + td4.id).css("background-color", "white");
            }
            //Set Positive 2
            else if(actualValue > check2 && actualValue <= check3){
                $( '#' + td1.id).css("background-color", "orange");
                $( '#' + td2.id).css("background-color", "orange");  
                $( '#' + td3.id).css("background-color", "orange");
                $( '#' + td4.id).css("background-color", "white");

            }
            //Set Positive 3
            else if(actualValue > check3){
                $( '#' + td1.id).css("background-color", "red");
                $( '#' + td2.id).css("background-color", "red");  
                $( '#' + td3.id).css("background-color", "red");  
                $( '#' + td4.id).css("background-color", "red"); 
            } 
        };
      
    </script>

</head>

<body>

	<!--enabling tabs-->	
	<script language="javascript">
		$('#myTabs a').click(function (e) {
		  e.preventDefault()
		  $(this).tab('show')
		})

		$('#myTabs a[href="#profile"]').tab('show') // Select tab by name
		$('#myTabs a:first').tab('show') // Select first tab
		$('#myTabs a:last').tab('show') // Select last tab
		$('#myTabs li:eq(2) a').tab('show') // Select third tab (0-indexed)

		$('#someTab').tab('show')
		
		$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
		  e.target // newly activated tab
		  e.relatedTarget // previous active tab
		})
	</script>
	<!--end enabling tabs-->
	
	<!--Horizontal Nav Bar at Top, credit to http://www.bootply.com/98314-->
		<nav class="navbar navbar-default" role="navigation">
		  <div class="navbar-header">
		    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		      <span class="icon-bar"></span>
		      <span class="icon-bar"></span>
		      <span class="icon-bar"></span>
		    </button>    
		  </div>
		  <a class="navbar-brand" href="#">MUMS</a>
		  <div class="navbar-collapse collapse">
		    <!--<ul class="nav navbar-nav navbar-left">
		        <li><a href="#">Left</a></li>
		        <li><a href="#about">Left</a></li>
		    </ul>-->
		    <ul class="nav navbar-nav navbar-right">
		      <li>
		      	<a href="#about">
		      		<span class="glyphicon glyphicon-camera" aria-hidden="true"></span> Start New Test</a>
		      </li>
		      <li><a href="Dashboard.html"><span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span> Back To Database</a>
		      </li>
		    </ul>
		  </div>
		</nav>
	<!--end nav bar-->

	<!--tab header-->
	<ul id="mainTabs" style="margin-bottom:20px;" class="nav nav-tabs">
	  <li class="active"><a data-toggle="tab" href="#home">Overview</a></li>
	  <li><a data-toggle="tab" href="#results">Results</a></li>
	  <li><a data-toggle="tab" href="#notes">Notes</a></li>
	</ul>
	<!--end tab header-->

	<div class="tab-content">
		  <div id="home" class="tab-pane fade in active">
		  
			<div id="container">

			            
			            <div id="main" class="row">
			                
			                <div id="profile" class="col-sm-3" style="margin-left:10px;">
			                        <img class="img-responsive" style="margin-bottom:-30px; height:250px" name="photo" src="IMG_1978.png"><br>

									<h3 id="patientTitle"></h3>

								
							</div><!--end profile(name and pic)-->

			                    <div id="patientInfo" class="col-sm-2">
			                      
			                        <label for="location">Location:</label>
			                        <p id="location"></p>
                                    
                                    <label for="known_drug_allergies">Known Drug Allergies:</label>
			                        <p id="known_drug_allergies"></p>
                                    
                                    <label for="medical_history">Medical History:</label>
			                        <p id="medical_history"></p>

			                    </div>  
			                   
			            
			 
			                <div id="spacer" class="col-sm-1" ></div>
			                <div id="recentLevels" class="col-sm-5">
			                     	<!--dropdown lists-->
			                        <div style="margin-bottom: 10px;"class="dropdown">
										<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
										    Select date
										    <span class="caret"></span>
										</button>
											</br>
										  	<ul id="dateDropdown" class="dropdown-menu" aria-labelledby="dropdownMenu1">
<!--here-->
										  </ul>

									</div> 
									<!--end dropdown-->  
                                        <h4 id="tableTitle"></h4>
					                    <table id="overviewTable" class="table table-striped">
										    <tbody>
										      <tr>
										        <td>pH</td>
										        <td id="pH"></td>
										       
										      </tr>
										      <tr>
										        <td>Nitrite</td>
										        <td id="nitrite"></td>
										    
										      </tr>
										      <tr>
										        <td>Ketone</td>
										        <td id="ketone"></td>
										       
										      </tr>
										      <tr>								
										        <td>Glucose</td>
										        <td id="glucose"></td>
										   
										      </tr>
										    </tbody>
										</table>
		                       
			               			 </div><!--end results table-->
			               			 <div id="spacer" class="col-sm-1"></div>
			                
			            </div><!--end main-->

						<div id="secondary" class="row">

							<div class="well well-lg">oh hey</div> 


						</div><!--end secondary-->
			            
			</div><!--end container div-->






		 </div><!--end home tab-->



<div id="results" class="tab-pane fade">
		    
<!--
		<div class="container">
			  <h2>Colored Progress Bars</h2>
			  <p>The contextual classes colors the progress bars:</p> 
			<div class="progress">
			    <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width:40%">
			      40% Complete (success)
			    </div>
			</div>
			<div class="progress">
			    <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width:50%">
			      50% Complete (info)
			    </div>
			</div>
			<div class="progress">
			    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width:60%">
			      60% Complete (warning)
			    </div>
			</div>
			<div class="progress">
			    <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100" style="width:70%">
			      70% Complete (danger)
			    </div>
			</div>

    
		<div class="progress">
		    <div class="progress-bar progress-bar-info" id="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
		    progress    
		    </div>
		</div>

		<script>
		$(function() {
		  var value = 0;
		  var interval = setInterval(function() {
		      value += 10;
		      $("#progress-bar")
		      .css("width", value + "%")/*this is how the css is changed to move the bar, could also be used to change the color of the bar*/
		      .attr("aria-valuenow", value)
		      .text(value + "%");
		      if (value >= 100)
		          clearInterval(interval);
		  }, 1000);
		});
		</script>

<!--end dynamic progress bar-->

<!--progress bar that updates with javascript-->
  
		<!--end container-->

    
			                <div id="allResults" class="col-sm-5">
			                     	<!--dropdown lists-->
			                        <div style="margin-bottom: 10px;"class="dropdown">
										<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
										    Select date
										    <span class="caret"></span>
										</button>
											</br>
										  	<ul id="dateDropdown2" class="dropdown-menu" aria-labelledby="dropdownMenu1">
<!--here-->
										  </ul>

									</div> 
									<!--end dropdown-->  

                                    <div>
                                        <h4 id="tableTitle2"></h4>
                                        
					                    <table class="table">
										    <thead>
                                                <tr>
                                                    <th></th>
                                                    <th>Negative</th>
                                                    <th>Positive 1</th>
                                                    <th>Positive 2</th>
                                                    <th>Positive 3</th>
                                                </tr>
                                            </thead>                    
                                            <tbody>
										      <tr>
										        <td>pH</td>
										        <td id="pH2"></td>
                                                <td id="pH_pos1"></td>
										        <td id="pH_pos2"></td>
                                                <td id="pH_pos3"></td>
										      </tr>
										      <tr>
										        <td>Nitrite</td>
										        <td id="nitrite2"></td>
										        <td id="nitrite_pos1"></td>
										        <td id="nitrite_pos2"></td>
                                                <td id="nitrite_pos3"></td>
										      </tr>
										      <tr>
										        <td>Ketone</td>
										        <td id="ketone2"></td>
										        <td id="ketone_pos1"></td>
										        <td id="ketone_pos2"></td>
                                                <td id="ketone_pos3"></td>
										      </tr>
										      <tr>								
										        <td>Glucose</td>
										        <td id="glucose2"></td>
										        <td id="glucose_pos1"></td>
										        <td id="glucose_pos2"></td>
                                                <td id="glucose_pos3"></td>
										      </tr>
										    </tbody>
										</table>
		                       
                                    </div> 
                                    <!--end results table--> 
			               			 </div>   
    
    
    
    
    
</div><!--end results tab-->



<div id="notes" class="tab-pane fade">
		    
	<div class="container">
	    <h3>Menu 2</h3>
	    <p>Some content in menu 2.</p>
	</div>

</div><!--end notes tab div-->



</body>
</html>